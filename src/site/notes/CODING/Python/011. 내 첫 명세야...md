---
{"dg-publish":true,"permalink":"/CODING/Python/011. 내 첫 명세야../","noteIcon":"2"}
---

### AgentManager{ #a9610a}

에이전트 목록을 관리하는 매니저

1. 에이전트 등록 (add_agent)
	- 설명: 설정 파일을 읽고, 새로운 에이전트를 시스템에 등록
	- 입력: config.yaml 파일명
	- 출력: 등록 성공 여부 또는 에러 메시지
	- 예시: `python api.py add chatassistant.yaml`
	- 추가: 에이전트 생성 시 모델 어댑터를 통해 다양한 LLM 지원
	- 추가: 에이전트 인터페이스 확인으로 호환성 검증

2. 에이전트 제거 (remove_agent)
	- 설명: 등록된 에이전트를 시스템에서 제거
	- 입력: 에이전트 이름 (등록 시 사용한 name 값과 일치해야 함)
	- 출력: 제거 성공 여부
	- 예시: `python api.py remove Chatassistant`

3. 에이전트 목록 조회 (list_agents)
	- 설명: 현재 등록된 모든 에이전트를 출력
	- 출력: 등록된 모든 에이전트의 요약 정보 리스트
	- 예시: `[{"name": "ChatAssistant", "model": "gpt-4", "description": "..."}]`
	- 추가: 각 에이전트의 capabilities 정보 포함

4. 모델 관리 (manage_models)
	- 설명: 시스템에서 사용 가능한 LLM 모델 관리
	- 기능: 모델 등록/제거/변경
	- 출력: 모델 등록 성공 여부


### AgentBroker{ #318bc8}

두가지 일을 한다.
유저의 메세지를 파악하여 어떤 에이전트가 필요한지 선택
해당 에이전트에게 메세지를 전달하고 응답을 받음
#todo 에이전트간 메세지를 라우팅 ex) 검색 에이전트 내용을 요약 에이전트에게 전달 등

1. 필요한 에이전트 파악 (analyze_message)
	- 설명: 유저의 메세지를 읽고, 어떤 에이전트에게 메세지를 전달할지 파악
	- 입력: 유저 메세지
	- 출력: `[AgentName, AgentName ...]`메세지를 보내야할 에이전트 (체이닝 해야할 경우 순서대로)
	- 추가: 메시지 내용에 따라 적합한 워크플로우 선택 기능

2. 워크플로우 실행 (execute_workflow)
	- 설명: 사전 정의된 에이전트 협업 패턴 실행
	- 입력: 워크플로우 ID와 초기 메시지
	- 출력: 워크플로우 실행 결과

3. 에이전트에게 메세지 전달 (dispatch_message)
	- 설명: 메세지를 리스트에 들어있는 에이전트에게 보내고 응답 받아옴 (이번 응답을 다음 에이전트에게 전달)
	- 입력: 응답을 보내야 할 에이전트 리스트
	- 출력: 최종 에이전트의 응답
	- 추가: 비동기 처리 지원으로 여러 에이전트에 동시 요청 가능

4. 결과 취합 및 조정 (aggregate_results)
	- 설명: 여러 에이전트의 응답을 취합하고 필요시 조정
	- 입력: 에이전트 응답 목록
	- 출력: 조정된 최종 응답

5. 최종 응답 사용자에게 전달(send_response)
	- 설명: 최종 에이전트의 응답을 사용자 또는 상위 시스템(UI, API 등)에 전달
	- 입력: 응답 메세지
	- 출력: 사용자 응답 전송 성공 여부 (또는 화면 출력 등)


### ModelAdapter
다양한 LLM 모델을 일관된 인터페이스로 추상화

1. 메시지 생성 (generate)
	- 설명: 프롬프트를 받아 모델에 맞는 형식으로 변환하여 요청, 응답 반환
	- 입력: 프롬프트, 파라미터
	- 출력: 모델 응답

2. 모델 정보 반환 (get_model_info)
	- 설명: 현재 사용 중인 모델의 정보 반환
	- 출력: 모델 이름, 버전, 제공자 등의 정보


### Agent 인터페이스
모든 에이전트가 구현해야 하는 공통 인터페이스
1. 메시지 처리 (process_message)
   - 설명: 입력 메시지를 받아 처리하고 응답 반환
   - 입력: 사용자 또는 다른 에이전트로부터의 메시지
   - 출력: 처리된 응답

2. 도구 사용 (use_tool)
   - 설명: 에이전트가 사용 가능한 도구를 실행
   - 입력: 도구 이름, 파라미터
   - 출력: 도구 실행 결과

3. 능력 정보 제공 (get_capabilities)
   - 설명: 에이전트가 할 수 있는 작업 목록 반환
   - 출력: 능력 목록 (예: {"can_search": true, "can_code": false})


### ConfigManager
설정 파일을 관리하고 시스템 구성을 유지
1. 설정 로드 (load_config)
   - 설명: YAML 파일에서 설정 로드
   - 입력: 설정 파일 경로
   - 출력: 파싱된 설정 객체

2. 설정 저장 (save_config)
   - 설명: 현재 설정을 YAML 파일로 저장
   - 입력: 설정 객체, 파일 경로
   - 출력: 저장 성공 여부

3. 설정 검증 (validate_config)
   - 설명: 설정이 유효한지 검증
   - 입력: 설정 객체
   - 출력: 검증 결과와 오류 메시지


### WorkflowManager
에이전트 간 협업 패턴(워크플로우)을 관리
1. 워크플로우 등록 (register_workflow)
   - 설명: 새 워크플로우를 시스템에 등록
   - 입력: 워크플로우 ID, 워크플로우 정의
   - 출력: 등록 성공 여부

2. 워크플로우 실행 (execute_workflow)
   - 설명: 지정된 워크플로우를 실행
   - 입력: 워크플로우 ID, 초기 입력
   - 출력: 워크플로우 실행 결과
### 설정 파일 (config/*.yaml)
- 설명: 에이전트 설정을 .yaml 파일로 정의
- 내용 필드:
	- name: 에이전트 이름
	- model: 사용될 모델
	- description: 에이전트의 역할 설명
	- system_prompt: 에이전트에게 전달할 프롬프트
	- tools (optional): 에이전트가 사용할 외부 도구 목록
	- params (optional): LLM API 호출 시 temperature, max_tokens 등 세부 파라미터

### 로깅 및 히스토리 저장 (logger)
- 설명: 메시지 전송 및 응답 기록 저장
- 출력: 로그 파일 또는 DB

### 테스트 실행 기능
- 설명: 설정 파일을 통해 에이전트를 등록하지 않고, 임시로 생성 후 메시지를 전달하고 응답을 확인
- 입력: config.yaml, test message
- 출력: LLM 응답
- 예시: `python api.py test chat_assistant.yaml "한국 날씨 알려줘"`

---

### 추가 기능 

| 기능             | 설명                                       | 우선순위 |
|----------------|------------------------------------------|--------|
| 설정파일 UI 편집기  | YAML을 직접 안 보고 편집하는 웹/터미널 UI         | 중      |
| 비동기 처리         | 여러 에이전트에게 동시에 요청 보내기                 | 중      |
| 플러그인 시스템     | 새로운 에이전트를 등록할 때 플러그인 방식 사용         | 중상     |
| 에러 처리          | 상황에 맞는 에이전트가 없을 때 등                  | 높음     |

---
### 고려 사항
- 에이전트 간에 결과를 전달하는 과정을 개선해야함
  -> 에이전트의 출력을 그대로 입력으로 넣을 경우 핀트가 엇나가는 경우가 있음
- 핫 리로드
  -> watchdog 같은 걸로 config 변경 감지 → self.load_agents() 호출
- 각 스텝에서 나온 결과를 가공하거나 병합하는 핸들러 추가
- 중간 결과 로깅
- 
