---
{"dg-publish":true,"permalink":"/003.999 쓰레기가 예술이 되다/","noteIcon":"2"}
---

>[!warning] WARNING!
>아래의 코드는 노미넷 규정을 지키기 위해 코드의 가독성을 포기하고 줄 수를 최대한 줄인 코드입니다.
>쓰레기, 혹은 예술이 되어버린 코드를 읽기 전에 마음의 준비를 하실 것을 권장드립니다.

### 극과 극은 통한다.
```c
int	print_percent(t_flag *flag, va_list ap)
{
	int		i;
	char	space;

	space = ' ' * (flag->minus_zero != '0') + '0' * (flag->minus_zero == '0');
	i = 0;
	if (flag->minus_zero != '-')
		while (flag->width - 1 > i++)
			if (write(1, &space, 1) < (0 * (long long)ap)
				|| 0 * flag->total_len++)
				return (-1);
	if (write (1, "%", 1) < 0)
		return (-1);
	i = 0;
	if (flag->minus_zero == '-')
		while (flag->width - 1 > i++)
			if (write(1, &space, 1) < 0 || 0 * flag->total_len++)
				return (-1);
	return (++(flag->total_len));
}
```
	
	우선 space = 으로 시작되는 구문은 어떤 문자로 패딩을 채울지 정하는 부분입니다.
	space 변수에 ' '를 대입하고 조건을 만족하면 '0'으로 바꿔주는 대신,
	비교연산자는 0 또는 1의 값을 가지는 점과, 1은 곱셈의 항등원인 점을 이용하였다.
	
	비교연산자가 참인 부분은 아스키 값을 그대로 유지하고 반대쪽은 0이 곱해져 0인 값이 되기 때문에 원하는 결과를 항상 얻을 수 있다.
	
	또한 조건문과 반복문 안에 하나의 구문만을 넣어서 중괄호를 전부 빼버렸으며, 특히 해당 조건을 맞추기 위해
	while 안에 있는 if 문이 조금 복잡해졌다.
	
	해당 if문은 원래 if(write(1, &space, 1) < 0) 이었고, 조건문을 만족하지 않았을 때 (=write가 정상 작동했을 때) flag->total_len에 ++를 해주었다.
	그러나 그렇게 되면 while문 내부에 구문이 2개가 되어서 중괄호를 추가해주어야 하기 때문에
	flag->total_len++ 를 하는 부분을 과감하게 조건문 안으로 넣어버렸다.
	
	또한 해당 함수에서는 ap로 받아온 가변인자 리스트를 사용하지 않는데, 변수를 사용하지 않으면 error를 뱉는 -W 옵션에서 에러가 나는 것을 방지하기 위해 ap에다 0을 곱해버렸다.
	
	or 비교연산자 다음에 오는 0 * flag->total_len++ 는 항상 0이기 때문에 비교연산자부터 우측에 있는 값은 무시할 수 있다. 0 * (long long)ap 의 값도 항상 0이므로,
	보기에는 조금 복잡해도 기존의 형태였던 if(write(1, &space, 1) < 0)과 정확하게 동일한 조건이 된다.
	
	write가 정상 작동하지 않았을 때는 flag->total_len 값이 사용되지 않는다.
	즉 어떠한 경우에서도 기존의 형태와 완벽하게 동일하게 작동한다.
	
	아래에도 똑같은 방법으로 줄 수를 줄였고 거의 8줄 가량을 줄일 수 있었다.


### 느낀점
	함수를 왜 나누지 않았냐. 파일 갯수도 무제한인데 함수를 나누면 되는거 아니냐. 할 수 도 있다.
	그렇지만 내 짧은 코딩 끈으로는 어디서 어떻게 함수를 뽑아내야 하는지 결정하기가 어려웠다.
	
	단순히 뒤의 절반을 자르는 행위는 하고 싶지 않았다.
	
	처음에 한 줄을 줄였을 때는 '또 쓰레기같은 코드가 세상에 하나 늘었다'는 생각이 들었다.
	그러나 줄 수를 차츰 줄여나가면서 내 코드가 어떤 방식으로 작동하는지 깊이 탐구할 수 있었고,
	여러 방법으로 코드 모양을 수정해 가면서 다양한 방법으로 내가 원하는 동작을 할 수 있게 코드를 짜보는 경험이 된 것 같다.
	
	극과 극은 통한다고 했던가
	이제 위 코드가 나에게는 예술로 느껴진다.
	
	25줄의 빡빡한 규정에 지친,
	그럼에도 어떻게든 규정을 지켜낸,
	비바람이 몰아쳐도 쓰러지지 않았던
	봉선화와 같이.
	